function requestWebcam(b,c){this.video_in=b||null;this.video_out=c||null;this.data_array=[];this.stream=null;this.recorder=null;this.blob=null;this.browser=navigator.userAgent;
}requestWebcam.prototype.getVideo_in=function(){return this.video_in;};requestWebcam.prototype.getVideo_out=function(){return this.video_out;};requestWebcam.prototype.getData_array=function(){return this.data_array;
};requestWebcam.prototype.getStream=function(){return this.stream;};requestWebcam.prototype.getRecorder=function(){return this.recorder;};requestWebcam.prototype.getBlob=function(){return this.blob;
};requestWebcam.prototype.forgetPermission=function(c){for(var b=0;b<this.stream.getTracks().length;b++){this.stream.getTracks()[b].stop();}if(c&&typeof c==="function"){c();
}};requestWebcam.prototype.requestPermission=function(d,b){var c=this;navigator.mediaDevices.getUserMedia({video:true,audio:true}).then(function(e){c.stream=e;
if(c.video_in){document.getElementById(c.video_in).src=URL.createObjectURL(c.stream);}if(d&&typeof d==="function"){d();}}).then(null,b&&typeof b==="function"?b:function(e){console.log(e.name+": "+e.message);
});};requestWebcam.prototype.startRecording=function(){var b=this;if(this.browser.indexOf("Chrome")>-1){b.recorder=new MediaRecorder(b.stream);b.recorder.start();
b.recorder.ondataavailable=function(c){b.data_array.push(c.data);};}else{if(b.browser.indexOf("Firefox")>-1||b.browser.indexOf("Opera")>-1){b.recorder=new MediaRecorder(b.stream);
b.recorder.start();}else{b.recorder=new MediaRecorder(b.stream);b.recorder.start();b.recorder.ondataavailable=function(c){b.data_array.push(c.data);};}}};
requestWebcam.prototype.stopRecording=function(c){var b=this;if(b.browser.indexOf("Chrome")>-1){b.recorder.stop();b.blob=new Blob(b.data_array,{type:"video/mp4"});
b.urlobj=URL.createObjectURL(b.blob);if(b.video_out){document.getElementById(b.video_out).src=URL.createObjectURL(b.blob);}if(c&&typeof c==="function"){setTimeout(c(),500);
}b.data_array=[];}else{if(b.browser.indexOf("Firefox")>-1||b.browser.indexOf("Opera")>-1){b.recorder.ondataavailable=function(d){b.urlobj=URL.createObjectURL(d.data);
b.blob=new Blob([d.data],{type:"video/mp4"});if(b.video_out){document.getElementById(b.video_out).src=URL.createObjectURL(d.data);}console.log(c);if(c&&typeof c==="function"){setTimeout(c(),500);
}};b.recorder.stop();}else{b.recorder.stop();b.blob=new Blob(b.data_array,{type:"video/mp4"});b.urlobj=URL.createObjectURL(b.blob);if(b.video_out){document.getElementById(b.video_out).src=URL.createObjectURL(b.blob);
}if(c&&typeof c==="function"){setTimeout(c(),500);}b.data_array=[];}}};requestWebcam.prototype.download=function(){var b=this;a=document.createElement("a");
a.style="display: none";a.download=["video_",(new Date()+"").slice(4,28),".mp4"].join("");a.href=b.urlobj;a.textContent=a.download;document.body.appendChild(a);
a.click();setTimeout(function(){document.body.removeChild(a);URL.revokeObjectURL(a.href);},900);};